import{m as U,c as I}from"./modalMixins-520f885a.js";import{k as V,l as f,m as k,_ as w,o as r,c as u,a as t,w as h,d as n,v as p,F as x,n as M,p as D,h as F,q as N,s as S,u as T,i as y,t as b,x as j,r as v,b as P}from"./index-a1dbf405.js";import{T as O}from"./ToastMessage-765da476.js";const L=V("productStore",{state:()=>({products:[],toastMessages:[],isLoading:!1}),actions:{async getProductList(){const e="https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/products/all";this.isLoading=!0,await f.get(e).then(s=>{s.data.success?this.products=s.data.products:this.toastMessages.push({style:"danger",title:"取得列表失敗",content:s.data.message.join("、")})}),this.isLoading=!1},async removeProduct(e){const s=`https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/product/${e}`;this.isLoading=!0,await f.delete(s).then(l=>{l.data.success?(this.getProductList(),this.toastMessages.push({style:"success",title:"刪除成功"})):this.toastMessages.push({style:"danger",title:"刪除失敗",content:l.data.message.join("、")})}),this.isLoading=!1},async addProduct(e){let s="https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/product",l="post";e.isNew===!1&&(s=`https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/product/${e.id}`,l="put"),this.isLoading=!0,await f[l](s,{data:e}).then(a=>{a.data.success?(this.getProductList(),this.toastMessages.push({style:"success",title:l==="post"?"新增成功":"編輯成功",content:""})):this.toastMessages.push({style:"danger",title:"失敗",content:a.data.message.join("、")})}),this.isLoading=!1}}});const R={props:{product:{type:Object,default(){return{}}}},data(){return{modal:{},addProductList:{imagesUrl:[]},mainImgChecked:""}},watch:{product(){this.addProductList={...this.product,imagesUrl:this.product.imagesUrl||[]}}},mixins:[U],methods:{...k(L,["addProduct"]),updateImgFile(){const e=this.$refs.fileInput.files[0],s=new FormData;s.append("file-to-upload",e);const l="https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/upload";this.$refs.imageInput.value?this.addProductList.imageUrl?this.addProductList.imagesUrl.push(this.$refs.imageInput.value):this.addProductList.imageUrl=this.$refs.imageInput.value:this.addProductList.imageUrl?f.post(l,s).then(a=>{a.data.success&&this.addProductList.imagesUrl.push(a.data.imageUrl)}):f.post(l,s).then(a=>{a.data.success&&(this.addProductList.imageUrl=a.data.imageUrl)}),this.$refs.imageInput.value="",this.$refs.fileInput.value=""},delImages(e){e===-1?this.addProductList.imageUrl="":this.addProductList.imagesUrl.splice(e,1)},selectToMain(e){this.addProductList.imagesUrl[e]=this.addProductList.imageUrl,this.addProductList.imageUrl=this.mainImgChecked,this.mainImgChecked=""}}},d=e=>(S("data-v-2d26bd42"),e=e(),T(),e),B={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},q={class:"modal-dialog modal-xl",role:"document"},A={class:"modal-content border-0"},E=d(()=>t("div",{class:"modal-header text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),z={class:"modal-body"},G={class:"row"},H={class:"col-sm-4"},J={class:"mb-3"},K=d(()=>t("label",{for:"image",class:"form-label"},"輸入圖片網址",-1)),Q={type:"text",class:"form-control",id:"image",ref:"imageInput",placeholder:"請輸入圖片連結"},W={class:"mb-3"},X=d(()=>t("label",{for:"customFile",class:"form-label"},[y("或 上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1)),Y={type:"file",id:"customFile",class:"form-control",ref:"fileInput"},Z={class:"mt-3"},tt={class:"mb-3"},st={class:"d-flex"},et=d(()=>t("p",{class:"fw-bolder mb-2"},"主要圖片",-1)),ot=d(()=>t("i",{class:"bi bi-trash"},null,-1)),it=[ot],dt=["src"],lt={key:0,class:"row"},at=d(()=>t("p",{class:"fw-bolder mb-2"},"次要圖片",-1)),ct={class:"form-check d-flex ps-0"},nt={class:"form-check form-check-inline"},rt=["id","value","onChange"],ut=d(()=>t("label",{class:"form-check-label",for:"inlineRadio1"},"選為主要",-1)),mt=["onClick"],pt=d(()=>t("i",{class:"bi bi-trash"},null,-1)),ht=[pt],_t=["src"],bt={class:"col-sm-8"},gt={class:"mb-3"},ft=d(()=>t("label",{for:"title",class:"form-label"},"標題",-1)),vt={class:"row gx-2"},Pt={class:"mb-3 col-md-6"},yt=d(()=>t("label",{for:"category",class:"form-label"},"分類",-1)),Lt={class:"mb-3 col-md-6"},xt=d(()=>t("label",{for:"price",class:"form-label"},"單位",-1)),kt={class:"row gx-2"},wt={class:"mb-3 col-md-6"},Ut=d(()=>t("label",{for:"origin_price",class:"form-label"},"原價",-1)),Mt={class:"mb-3 col-md-6"},$t=d(()=>t("label",{for:"price",class:"form-label"},"售價",-1)),Ct=d(()=>t("hr",null,null,-1)),It={class:"mb-3"},Vt=d(()=>t("label",{for:"description",class:"form-label"},"產品描述",-1)),Dt={class:"mb-3"},Ft=d(()=>t("label",{for:"content",class:"form-label"},"說明內容",-1)),Nt={class:"mb-3"},St={class:"form-check"},Tt=d(()=>t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1)),jt={class:"modal-footer"},Ot=d(()=>t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1));function Rt(e,s,l,a,o,c){return r(),u("div",B,[t("div",q,[t("div",A,[E,t("div",z,[t("div",G,[t("div",H,[t("div",J,[K,t("input",Q,null,512)]),t("div",W,[X,t("input",Y,null,512),t("div",Z,[t("button",{class:"btn btn-outline-primary btn-md d-block w-100",onClick:s[0]||(s[0]=h((...i)=>c.updateImgFile&&c.updateImgFile(...i),["prevent"]))}," 新增圖片 ")])]),t("div",tt,[t("div",st,[et,t("a",{href:"javascript:void(0)",class:"d-block ms-auto",onClick:s[1]||(s[1]=h(i=>c.delImages(-1),["prevent"]))},it)]),n(t("input",{type:"text",id:"image-url",class:"form-control","onUpdate:modelValue":s[2]||(s[2]=i=>o.addProductList.imageUrl=i)},null,512),[[p,o.addProductList.imageUrl]]),t("img",{class:"img-fluid mt-3 main-img",alt:"",src:o.addProductList.imageUrl},null,8,dt)]),o.addProductList.imagesUrl?(r(),u("div",lt,[at,(r(!0),u(x,null,M(o.addProductList.imagesUrl,(i,_)=>(r(),u("div",{class:"col-md-6 mb-2",key:_},[t("div",ct,[t("div",nt,[n(t("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:`inlineRadio${_}`,value:i,"onUpdate:modelValue":s[3]||(s[3]=g=>o.mainImgChecked=g),onChange:g=>c.selectToMain(_)},null,40,rt),[[D,o.mainImgChecked]]),ut]),t("a",{href:"javascript:void(0)",class:"d-block ms-auto",onClick:h(g=>c.delImages(_),["prevent"])},ht,8,mt)]),t("img",{src:i,alt:"圖片1",class:"img-fluid card-img"},null,8,_t)]))),128))])):F("",!0)]),t("div",bt,[t("div",gt,[ft,n(t("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":s[4]||(s[4]=i=>o.addProductList.title=i)},null,512),[[p,o.addProductList.title]])]),t("div",vt,[t("div",Pt,[yt,n(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入分類","onUpdate:modelValue":s[5]||(s[5]=i=>o.addProductList.category=i)},null,512),[[p,o.addProductList.category]])]),t("div",Lt,[xt,n(t("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入單位","onUpdate:modelValue":s[6]||(s[6]=i=>o.addProductList.unit=i)},null,512),[[p,o.addProductList.unit]])])]),t("div",kt,[t("div",wt,[Ut,n(t("input",{type:"number",class:"form-control",id:"origin_price",placeholder:"請輸入原價","onUpdate:modelValue":s[7]||(s[7]=i=>o.addProductList.origin_price=i)},null,512),[[p,o.addProductList.origin_price]])]),t("div",Mt,[$t,n(t("input",{type:"number",class:"form-control",id:"price",placeholder:"請輸入售價","onUpdate:modelValue":s[8]||(s[8]=i=>o.addProductList.price=i)},null,512),[[p,o.addProductList.price]])])]),Ct,t("div",It,[Vt,n(t("textarea",{type:"text",class:"form-control",id:"description",placeholder:"請輸入產品描述","onUpdate:modelValue":s[9]||(s[9]=i=>o.addProductList.description=i)},null,512),[[p,o.addProductList.description]])]),t("div",Dt,[Ft,n(t("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":s[10]||(s[10]=i=>o.addProductList.content=i)},null,512),[[p,o.addProductList.content]])]),t("div",Nt,[t("div",St,[n(t("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":s[11]||(s[11]=i=>o.addProductList.is_enabled=i)},null,512),[[N,o.addProductList.is_enabled]]),Tt])])])])]),t("div",jt,[Ot,t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:s[12]||(s[12]=h(i=>e.addProduct(o.addProductList),["prevent"]))},"確認")])])])],512)}const Bt=w(R,[["render",Rt],["__scopeId","data-v-2d26bd42"]]),qt={props:{product:{type:Object}},mixins:[U],methods:{...k(L,["removeProduct"]),delProduct(e){this.removeProduct(e)}}},At={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Et={class:"modal-dialog",role:"document"},zt={class:"modal-content border-0"},Gt={class:"modal-header bg-danger text-white"},Ht={class:"modal-title"},Jt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Kt={class:"modal-body"},Qt={class:"text-danger"},Wt={class:"modal-footer"},Xt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function Yt(e,s,l,a,o,c){return r(),u("div",At,[t("div",Et,[t("div",zt,[t("div",Gt,[t("h5",Ht,[t("span",null,"刪除"+b(l.product.title),1)]),Jt]),t("div",Kt,[y(" 是否刪除 "),t("strong",Qt,b(l.product.title),1),y(" (刪除後將無法恢復)。 ")]),t("div",Wt,[Xt,t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:s[0]||(s[0]=i=>c.delProduct(l.product.id))},"確認刪除")])])])],512)}const Zt=w(qt,[["render",Yt]]),ts={components:{ProductDetail:Bt,DeleteProduct:Zt,ToastMessage:O},data(){return{currency:I,isNew:!1,currentProduct:{imagesUrl:[]}}},computed:{...j(L,["products","isLoading","toastMessages"])},methods:{...k(L,["getProductList"]),openModal(e,s){e?this.currentProduct={is_enabled:0,imagesUrl:[],isNew:!0}:(this.currentProduct={...s},this.currentProduct.isNew=!1),this.isNew=e,this.$refs.productDatail.showModal()},delModal(e){this.currentProduct={...e},this.$refs.deleteProduct.showModal()}},created(){this.getProductList()}},ss=t("h4",{class:"fw-bold py-3 mb-4"},[t("span",{class:"text-muted fw-light fs-4"},"Pages /"),y(" Product 產品")],-1),es={class:"card"},os={class:"card-header d-flex align-items-center"},is=t("h5",{class:"mb-0"},"Product 產品",-1),ds={class:"ms-auto"},ls={class:"table-responsive text-nowrap"},as={class:"table"},cs=t("thead",{class:"table-light"},[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"200"},"編輯")])],-1),ns={class:"table-border-bottom-0"},rs={class:"text-right"},us={class:"text-right"},ms={key:0,class:"text-success"},ps={key:1,class:"text-muted"},hs={class:"btn-group"},_s=["onClick"],bs=["onClick"];function gs(e,s,l,a,o,c){const i=v("LoadingOverlay"),_=v("ToastMessage"),g=v("ProductDetail"),$=v("DeleteProduct");return r(),u(x,null,[P(i,{active:e.isLoading},null,8,["active"]),P(_,{"toast-msg":e.toastMessages},null,8,["toast-msg"]),ss,t("div",es,[t("div",os,[is,t("div",ds,[t("button",{class:"btn btn-primary",type:"button",onClick:s[0]||(s[0]=h(m=>c.openModal(!0),["prevent"]))},"新增項目")])]),t("div",ls,[t("table",as,[cs,t("tbody",ns,[(r(!0),u(x,null,M(e.products,m=>(r(),u("tr",{key:m.id},[t("td",null,b(m.category),1),t("td",null,b(m.title),1),t("td",rs,b(o.currency(m.origin_price)),1),t("td",us,b(o.currency(m.price)),1),t("td",null,[m.is_enabled===1?(r(),u("span",ms,"啟用")):(r(),u("span",ps,"未啟用"))]),t("td",null,[t("div",hs,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:h(C=>c.openModal(!1,m),["prevent"])},"編輯",8,_s),t("button",{class:"btn btn-outline-danger btn-sm",onClick:h(C=>c.delModal(m),["prevent"])},"刪除",8,bs)])])]))),128))])])])]),P(g,{ref:"productDatail",product:o.currentProduct},null,8,["product"]),P($,{ref:"deleteProduct",product:o.currentProduct},null,8,["product"])],64)}const ys=w(ts,[["render",gs]]);export{ys as default};
